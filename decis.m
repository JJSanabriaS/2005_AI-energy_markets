% limpieza de variables
close all
clear all
%busqueda redes salvadas
redes=textread('redessalvadas.txt','%s');
tam=size(redes);   
% carga de la información asociada a la red
strcat('load ','_',char(redes));
redes=char(redes);
strrep(ans,'_',' ');
eval(ans);
% carga de los erchivos de tendencia y ciclo
c=dlmread('ciclo.txt');
tam=size(c);
res=[pra;y(1,1:1:tam(2))];
t=dlmread('tendencia.txt');
% calculo de las series y graficación
ct=c.*t(1,1:1:tam(2));
pr=res(1,:);
y=res(2,:);
%a1=redes(tam(1,1))
tam=size(pra);
figure
subplot(2,1,1)
plot(pra(:,1:1:tam(2)),'r')
hold;
plot(a(:,1:1:tam(2)),'g')
text(14.5,li+10,vect(1,:));
text(34.5,li+10,vect(2,:)); 
text(64.5,li+10,vect(3,:)); text(84.5,li+10,vect(4,:)); 
text(104.5,li+10,vect(5,:));text(130.5,li+10,vect(6,:));
text(154.5,li+10,vect(7,:));
title('Recuperación de la señal (real(rojo) calculadas RNA (verde)')
e=abs(pra-a);
e1=abs(pra-a)/pra;
larg=tam(2);
mad1=(sum(e)/larg); 
emc1=sqrt(((sum((e).^2))/larg));  
mape1=(sum(e1)/larg)*100;
[pra;a];
% creación de la figura 
%redes
dlmwrite('resultados.txt',ans,',')
set(gcf,'menubar','none');
set(gcf,'numbertitle','off');
redes=textread('redessalvadas.txt','%s');
set(gcf,'name',strcat('Recuperación de la serie con la ','_',char(redes)));
set(gcf,'color',[1 1 1]);
set(gcf,'position',[0 25 650 420])
% Colocación de las etiquetas
h1 = uicontrol(gcf, ...
	'Units','points', ...
	'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
	'fontname','MS Sans Serif',...
   'fontsize',10,...
	'HorizontalAlignment','left', ...
	'ListboxTop',0, ...
	'Position',[63 138.25 297 15.75], ...
   'String','Tipo de red', ...
	'BackgroundColor',[1 1 1],...   
	'Style','text', ...
   'Tag','StaticText1');
h1 = uicontrol(gcf, ...
	'Units','points', ...
	'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
	'fontname','MS Sans Serif',...
   'fontsize',10,...
	'HorizontalAlignment','left', ...
	'ListboxTop',0, ...
	'Position',[63 123.25 297 15.75], ...
   'String','Función de aprendizaje', ...
	'BackgroundColor',[1 1 1],...   
	'Style','text', ...
   'Tag','StaticText1');
h1 = uicontrol(gcf, ...
	'Units','points', ...
	'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
	'fontname','MS Sans Serif',...
   'fontsize',10,...
	'HorizontalAlignment','left', ...
	'ListboxTop',0, ...
	'Position',[63 108.25 297 15.75], ...
   'String','Función de entrenamiento', ...
	'BackgroundColor',[1 1 1],...   
	'Style','text', ...
	'Tag','StaticText1');
h1 = uicontrol(gcf, ...
	'Units','points', ...
	'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
	'fontname','MS Sans Serif',...
   'fontsize',10,...
	'HorizontalAlignment','left', ...
	'ListboxTop',0, ...
	'Position',[63 93.25 297 15.75], ...
   'String','Numero de capas (oculta)', ...
	'BackgroundColor',[1 1 1],...   
	'Style','text', ...
	'Tag','StaticText1');

% Colocación de los datos calculados
h1 = uicontrol(gcf, ...
	'Units','points', ...
	'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
	'fontname','MS Sans Serif',...
   'fontsize',10,...
	'HorizontalAlignment','left', ...
	'ListboxTop',0, ...
	'Position',[313 138.25 297 15.75], ...
   'String',tipored, ...
	'BackgroundColor',[1 1 1],...   
	'Style','text', ...
	'Tag','StaticText1');
h1 = uicontrol(gcf, ...
	'Units','points', ...
	'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
	'fontname','MS Sans Serif',...
   'fontsize',10,...
	'HorizontalAlignment','left', ...
	'ListboxTop',0, ...
	'Position',[313 123.25 297 15.75], ...
   'String',faprendiza, ...
	'BackgroundColor',[1 1 1],...   
	'Style','text', ...
	'Tag','StaticText1');
h1 = uicontrol(gcf, ...
	'Units','points', ...
	'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
	'fontname','MS Sans Serif',...
   'fontsize',10,...
	'HorizontalAlignment','left', ...
	'ListboxTop',0, ...
	'Position',[313 108.25 297 15.75], ...
   'String',fentrena, ...
	'BackgroundColor',[1 1 1],...   
	'Style','text', ...
	'Tag','StaticText1');
h1 = uicontrol(gcf, ...
	'Units','points', ...
	'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
	'fontname','MS Sans Serif',...
   'fontsize',10,...
	'HorizontalAlignment','left', ...
	'ListboxTop',0, ...
	'Position',[313 93.25 297 15.75], ...
   'String',nc, ...
	'BackgroundColor',[1 1 1],...   
	'Style','text', ...
	'Tag','StaticText1');
h1 = uicontrol(gcf, ...
	'Units','points', ...
	'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
	'fontname','MS Sans Serif',...
   'fontsize',10,...
	'HorizontalAlignment','left', ...
	'ListboxTop',0, ...
	'Position',[63 78.25 297 15.75], ...
   'String','Desv abs. de la media (MAD)', ...
	'BackgroundColor',[1 1 1],...   
	'Style','text', ...
	'Tag','StaticText1');
h1 = uicontrol(gcf, ...
	'Units','points', ...
	'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
	'fontname','MS Sans Serif',...
   'fontsize',10,...
	'HorizontalAlignment','left', ...
	'ListboxTop',0, ...
	'Position',[313 78.25 197 15.75], ...
   'String',mad1, ...
	'BackgroundColor',[1 1 1],...   
	'Style','text', ...
   'Tag','StaticText1');
h1 = uicontrol(gcf, ...
	'Units','points', ...
	'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
	'fontname','MS Sans Serif',...
   'fontsize',10,...
	'HorizontalAlignment','left', ...
	'ListboxTop',0, ...
	'Position',[373 78.25 30 15.75], ...
   'String',ulabel, ...
	'BackgroundColor',[1 1 1],...   
	'Style','text', ...
   'Tag','StaticText1');



h1 = uicontrol(gcf, ...
	'Units','points', ...
	'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
	'fontname','MS Sans Serif',...
   'fontsize',10,...
	'HorizontalAlignment','left', ...
	'ListboxTop',0, ...
	'Position',[63 63.25 297 15.75], ...
   'String','Raíz del error medio cuadrado (RMSE)', ...
	'BackgroundColor',[1 1 1],...   
	'Style','text', ...
	'Tag','StaticText1');
h1 = uicontrol(gcf, ...
	'Units','points', ...
	'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
	'fontname','MS Sans Serif',...
   'fontsize',10,...
	'HorizontalAlignment','left', ...
	'ListboxTop',0, ...
	'Position',[313 63.25 197 15.75], ...
   'String',emc1, ...
	'BackgroundColor',[1 1 1],...   
	'Style','text', ...
   'Tag','StaticText1');
h1 = uicontrol(gcf, ...
	'Units','points', ...
	'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
	'fontname','MS Sans Serif',...
   'fontsize',10,...
	'HorizontalAlignment','left', ...
	'ListboxTop',0, ...
	'Position',[373 63.25 30 15.75], ...
   'String',ulabel, ...
	'BackgroundColor',[1 1 1],...   
	'Style','text', ...
   'Tag','StaticText1');
h1 = uicontrol(gcf, ...
	'Units','points', ...
	'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
	'fontname','MS Sans Serif',...
   'fontsize',10,...
	'HorizontalAlignment','left', ...
	'ListboxTop',0, ...
	'Position',[63 48.25 297 15.75], ...
   'String','Porcentaje de error medio abs. (MAPE)', ...
	'BackgroundColor',[1 1 1],...   
	'Style','text', ...
	'Tag','StaticText1');
h1 = uicontrol(gcf, ...
	'Units','points', ...
	'BackgroundColor',[0.752941176470588 0.752941176470588 0.752941176470588], ...
	'fontname','MS Sans Serif',...
   'fontsize',10,...
	'HorizontalAlignment','left', ...
	'ListboxTop',0, ...
	'Position',[313 48.25 297 15.75], ...
   'String',mape1, ...
	'BackgroundColor',[1 1 1],...   
	'Style','text', ...
   'Tag','StaticText1');

tam=size(ct);
[pra(:,1:1:tam(2));a(:,1:1:tam(2))];
dlmwrite('resultados.txt',ans,',')
set(gcf,'menubar','none');
set(gcf,'numbertitle','off');
set(gcf,'color',[1 1 1]);
set(gcf,'position',[0 25 650 420])
redes=textread('redessalvadas.txt','%s');
tam=size(redes);
% Creación de los botones de acción
h1 = uicontrol(gcf, ...
	'Units','points', ...
	'BackgroundColor',[0.8 0.8 0.8], ...
	'Callback','reent', ...
	'ListboxTop',0, ...
	'Position',[100 5 45.75 14], ...
   'String','reentrenar', ...
   'Tag','Pushbutton1');
h1 = uicontrol(gcf, ...
	'Units','points', ...
	'BackgroundColor',[0.8 0.8 0.8], ...
	'Callback','predice1', ...
	'ListboxTop',0, ...
	'Position',[210 5 90 14], ...
   'String','predecir', ...
	'Tag','Pushbutton1');
h1 = uicontrol(gcf, ...
	'Units','points', ...
	'BackgroundColor',[0.8 0.8 0.8], ...
	'Callback','close', ...
	'ListboxTop',0, ...
	'Position',[350 5 45.75 14], ...
   'String','Abandonar', ...
   'Callback','close all',...
   'Tag','Pushbutton1');
